

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.2.1. Graphs &#8212; Software Development: A Pragmatic Approach 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4.2.2. Parsing" href="parse.html" />
    <link rel="prev" title="4.2. A fistful of Python exercises" href="py4_index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="parse.html" title="4.2.2. Parsing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="py4_index.html" title="4.2. A fistful of Python exercises"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Software Development: A Pragmatic Approach 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ch4_index.html" >4. Stage 2</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="py4_index.html" accesskey="U">4.2. A fistful of Python exercises</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.2.1. Graphs</a><ul>
<li><a class="reference internal" href="#graphviz-and-dot">4.2.1.1. Graphviz and dot</a></li>
<li><a class="reference internal" href="#parsing-dot-files">4.2.1.2. Parsing dot files</a></li>
<li><a class="reference internal" href="#the-hacky-way">4.2.1.3. The hacky way</a></li>
<li><a class="reference internal" href="#removing-unnecessary-edges">4.2.1.4. Removing unnecessary edges</a></li>
<li><a class="reference internal" href="#graph-traversal">4.2.1.5. Graph traversal</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="py4_index.html"
                        title="previous chapter">4.2. A fistful of Python exercises</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="parse.html"
                        title="next chapter">4.2.2. Parsing</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/py4.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="graphs">
<h1>4.2.1. Graphs<a class="headerlink" href="#graphs" title="Permalink to this headline">¶</a></h1>
<p>In this section we&#8217;ll learn a bit about <em>graphs</em>.</p>
<p>A graph is a collection of <em>nodes</em> as well as <em>edges</em> that connect nodes. There are lots of different kinds of graphs:</p>
<ul class="simple">
<li>The nodes or edges may have <em>labels</em></li>
<li>The edges may be <em>directional</em> (bidirectional or unidirectional)</li>
<li>The edges may have a <em>cost</em> associated with them</li>
</ul>
<p>As with the other topics in this book, we only treat graphs in a shallow way. Namely to solve a very precise problem.</p>
<p>Here&#8217;s an example graph:</p>
<img alt="_images/dependencies21.png" src="_images/dependencies21.png" />
<p>It&#8217;s a graph showing the dependencies between the toplevel chapters of this book. For example, the chapter &#8220;Unix shell&#8221; has &#8220;Introduction&#8221; as its dependency.</p>
<p>(Apart from describing dependencies between chapters, graphs can be used for describing other kinds of dependencies like in a supply chain. They can also be used to describe other relationships like distances or routes between places, relationships between people etc.)</p>
<p>Now, here&#8217;s the problem with this graph: it has too many edges. You see, the code that creates the edges for this graph isn&#8217;t very smart, so it includes some edges that strictly speaking don&#8217;t need to be there. For example, you see the edge from &#8220;Introduction&#8221; to &#8220;Javascript&#8221;? As &#8220;Javascript&#8221; already depends on &#8220;Unix shell&#8221; which depends on &#8220;Introduction&#8221;, there&#8217;s no need to have an edge from &#8220;Introduction&#8221; to &#8220;Javascript&#8221;. This edge can and should be removed.</p>
<p>We have two parts to this problem: one is finding the algorithm that does what we want it to do, i.e. remove the edges, and the other is putting this algorithm into use to actually generate a graph with unnecessary edges removed.</p>
<p>Can you think of how the algorithm to remove unnecessary edges would work?</p>
<p>One way to think of it is that an edge from A to C should be removed if we find an edge from B to C, where B is dependent on A, either directly or indirectly. That way we &#8220;only&#8221; need to keep track of which nodes are dependent on which. In pseudocode this could look something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">direct_child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_direct_child_nodes</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">other_child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">get_direct_child_nodes</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">other_child</span><span class="o">.</span><span class="n">depends_on</span><span class="p">(</span><span class="n">direct_child</span><span class="p">):</span>
                <span class="n">node</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">other_child</span><span class="p">)</span>
</pre></div>
</div>
<p>It&#8217;s probably a good idea to draw the above on paper to get an understanding of how it would work.</p>
<p>Now that we have a very rough description of an algorithm in place, we can consider the question about how we actually would create or modify a graph.</p>
<div class="section" id="graphviz-and-dot">
<h2>4.2.1.1. Graphviz and dot<a class="headerlink" href="#graphviz-and-dot" title="Permalink to this headline">¶</a></h2>
<p>Graphviz is a software suite for working with graphs. Dot is a program which is part of graphviz that produces images of graphs specified in the <em>dot</em> language. Here&#8217;s an example graph described in the dot language:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">digraph</span> <span class="n">g</span> <span class="p">{</span>
    <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">B</span><span class="p">;</span>
    <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">C</span><span class="p">;</span>
    <span class="n">B</span> <span class="o">-&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="n">C</span> <span class="o">-&gt;</span> <span class="n">D</span><span class="p">;</span>
    <span class="n">D</span> <span class="o">-&gt;</span> <span class="n">E</span><span class="p">;</span>
    <span class="n">A</span> <span class="o">-&gt;</span> <span class="n">E</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This file can be fed to the dot program, e.g. like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ dot -Tpng &lt; graph.dot &gt; graph.png
</pre></div>
</div>
<p>As you can see, dot takes the output format as a parameter, can read dot files from stdin and output to stdout. The result could look like this:</p>
<img alt="_images/graph.png" src="_images/graph.png" />
<p>(The edge from A to E is unnecessary.)</p>
<p><em>Exercise</em>: Install the graphviz suite on your computer. Run the above dot command to make sure you have everything set up correctly. Bonus points if you compile it from source.</p>
<p>As you can see, the dot language is fairly simple, at least in this case, and fairly intuitive.</p>
<p>Here&#8217;s a bit more complex example of a dot file - it&#8217;s the source for the graph at the beginning of this section:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">digraph</span> <span class="n">dep2</span> <span class="p">{</span>
    <span class="n">bin_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Working with binary data&quot;</span><span class="p">];</span>
    <span class="n">design_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Larger software&quot;</span><span class="p">];</span>
    <span class="n">ds3_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data structures - part two&quot;</span><span class="p">];</span>
    <span class="n">ds_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;First touch of algorithms&quot;</span><span class="p">];</span>
    <span class="n">edit_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Editors&quot;</span><span class="p">];</span>
    <span class="n">func_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Some concepts around functions&quot;</span><span class="p">];</span>
    <span class="n">git_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Some more git&quot;</span><span class="p">];</span>
    <span class="n">int_c_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Intermediate C&quot;</span><span class="p">];</span>
    <span class="n">int_py_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Useful Python tips&quot;</span><span class="p">];</span>
    <span class="n">int_web_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Intermediate web development&quot;</span><span class="p">];</span>
    <span class="n">intro_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Introduction&quot;</span><span class="p">];</span>
    <span class="n">js_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Javascript&quot;</span><span class="p">];</span>
    <span class="n">lang_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Programming language taxonomy&quot;</span><span class="p">];</span>
    <span class="n">ong_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Strongly, statically typed languages&quot;</span><span class="p">];</span>
    <span class="n">ud_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Learning to program using Sudoku&quot;</span><span class="p">];</span>
    <span class="n">unix_index</span> <span class="p">[</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unix shell&quot;</span><span class="p">];</span>

    <span class="n">int_c_index</span> <span class="o">-&gt;</span> <span class="n">bin_index</span><span class="p">;</span>
    <span class="n">ud_index</span> <span class="o">-&gt;</span> <span class="n">design_index</span><span class="p">;</span>
    <span class="n">ds_index</span> <span class="o">-&gt;</span> <span class="n">ds3_index</span><span class="p">;</span>
    <span class="n">unix_index</span> <span class="o">-&gt;</span> <span class="n">edit_index</span><span class="p">;</span>
    <span class="n">int_py_index</span> <span class="o">-&gt;</span> <span class="n">func_index</span><span class="p">;</span>
    <span class="n">unix_index</span> <span class="o">-&gt;</span> <span class="n">git_index</span><span class="p">;</span>
    <span class="n">unix_index</span> <span class="o">-&gt;</span> <span class="n">int_c_index</span><span class="p">;</span>
    <span class="n">ds_index</span> <span class="o">-&gt;</span> <span class="n">int_c_index</span><span class="p">;</span>
    <span class="n">lang_index</span> <span class="o">-&gt;</span> <span class="n">int_c_index</span><span class="p">;</span>
    <span class="n">lang_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">int_c_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">js_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">ds_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">intro_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">ds3_index</span> <span class="o">-&gt;</span> <span class="n">int_py_index</span><span class="p">;</span>
    <span class="n">git_index</span> <span class="o">-&gt;</span> <span class="n">int_web_index</span><span class="p">;</span>
    <span class="n">int_py_index</span> <span class="o">-&gt;</span> <span class="n">int_web_index</span><span class="p">;</span>
    <span class="n">func_index</span> <span class="o">-&gt;</span> <span class="n">int_web_index</span><span class="p">;</span>
    <span class="n">int_c_index</span> <span class="o">-&gt;</span> <span class="n">int_web_index</span><span class="p">;</span>
    <span class="n">js_index</span> <span class="o">-&gt;</span> <span class="n">int_web_index</span><span class="p">;</span>
    <span class="n">intro_index</span> <span class="o">-&gt;</span> <span class="n">js_index</span><span class="p">;</span>
    <span class="n">unix_index</span> <span class="o">-&gt;</span> <span class="n">js_index</span><span class="p">;</span>
    <span class="n">ds_index</span> <span class="o">-&gt;</span> <span class="n">js_index</span><span class="p">;</span>
    <span class="n">lang_index</span> <span class="o">-&gt;</span> <span class="n">js_index</span><span class="p">;</span>
    <span class="n">func_index</span> <span class="o">-&gt;</span> <span class="n">ong_index</span><span class="p">;</span>
    <span class="n">int_c_index</span> <span class="o">-&gt;</span> <span class="n">ong_index</span><span class="p">;</span>
    <span class="n">bin_index</span> <span class="o">-&gt;</span> <span class="n">ong_index</span><span class="p">;</span>
    <span class="n">lang_index</span> <span class="o">-&gt;</span> <span class="n">ong_index</span><span class="p">;</span>
    <span class="n">int_c_index</span> <span class="o">-&gt;</span> <span class="n">ud_index</span><span class="p">;</span>
    <span class="n">ong_index</span> <span class="o">-&gt;</span> <span class="n">ud_index</span><span class="p">;</span>
    <span class="n">intro_index</span> <span class="o">-&gt;</span> <span class="n">unix_index</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The main difference, apart from having more nodes and edges, is that the nodes have <em>IDs</em> associated with them, and each ID has <em>a label</em>. This way, the lengthy name that will be displayed for each node is only written once in the dot file, even when a node is referenced multiple times.</p>
<p>Now, what we could do is read in a dot file, <em>parse</em> it i.e. understand its contents and store a representation of it in a variable, modify the data structures representing the graph to remove edges we don&#8217;t want, and finally write out a new dot file with the edges removed which can then be fed to dot for generating a better graph. Sounds good?</p>
<p>How would you go about this problem in practice? Go ahead and give it a try using the dot file from above. The next section will walk you through solving this.</p>
</div>
<div class="section" id="parsing-dot-files">
<h2>4.2.1.2. Parsing dot files<a class="headerlink" href="#parsing-dot-files" title="Permalink to this headline">¶</a></h2>
<p>There are several ways to approach parsing dot files. We&#8217;ll introduce and implement two ways as part of this book: the <em>hacky</em> way and the <em>more accurate</em> way. Here are the pros and cons:</p>
<ul class="simple">
<li>The &#8220;hacky&#8221; way is faster to implement</li>
<li>However, the &#8220;hacky&#8221; way is designed to only work with dot files that are structurally very similar to the ones above; adding support for more dot features will be very difficult</li>
</ul>
<p>Conversely, the more accurate way is somewhat more difficult to implement but is closer to a &#8220;real&#8221; dot parser, such that extending it later will result in more maintainable code. In our case, the hacky way results in about 30 lines of Python code while the more accurate way will be about 150 lines. These numbers include not only parsing but also applying the algorithm to remove unnecessary edges.</p>
</div>
<div class="section" id="the-hacky-way">
<h2>4.2.1.3. The hacky way<a class="headerlink" href="#the-hacky-way" title="Permalink to this headline">¶</a></h2>
<p>The hacky way involves heavy use of regular expressions.</p>
<p>The principle is simple:</p>
<ul class="simple">
<li>For each line, see if it matches a pattern &#8220;(word) -&gt; (word);&#8221;</li>
<li>If not, print out the line (remember, we wanted to end up printing a dot file with the unnecessary edges removed), unless the line is simply a &#8216;}&#8217; which denotes the end of the dot file</li>
<li>If it does, note the two words as a link (key and value in a dictionary)</li>
</ul>
<p>After this, we&#8217;d end up with a dictionary describing all the links. The key of the dictionary would be a string while the value would be a list of strings, i.e. all the edges from a node.</p>
<div class="topic">
<p class="topic-title first">collections.defaultdict</p>
<p>collections.defaultdict is a handy little Python library that can be helpful when creating dictionaries. Without it, the code to append an element to a list which is the value in a dictionary would look e.g. like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">my_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
<span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span> <span class="c1"># key not in dict</span>
    <span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>What this code does is add a value to a list in a dictionary, unless the list doesn&#8217;t exist yet in which case it needs to be created first. collections.defaultdict simplifies this code:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>

<span class="n">my_dict</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span>
<span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span>
<span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="c1"># will automatically create a new list when needed</span>
</pre></div>
</div>
</div>
<div class="topic">
<p class="topic-title first">Regular expressions in Python</p>
<p>In Python, you can check if a regular expression matches a string by using e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[0-9]+&#39;</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;&quot;s&quot; is a number&#39;</span>
</pre></div>
</div>
<p>You can also <em>capture</em> what was matched with parentheses, e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">regex</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[a-z]*([0-9]+)[a-z]*([0-9]+)&#39;</span><span class="p">))</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;abc123def456&#39;</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;The number within &quot;s&quot; is:       &#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;The number at the end of &quot;s&quot; is:&#39;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, you can define which captured string you want via the parameter to group().</p>
</div>
<p>After this &#8220;parsing&#8221;, we can do the following:</p>
<ul class="simple">
<li>Apply our algorithm to remove unnecessary edges - that is, remove the unnecessary entries in our dictionary</li>
<li>Write out all the edges by simply printing &#8221;    %s -&gt; %s;&#8221; % (word1, word2)</li>
<li>Print &#8216;}&#8217; to close the dot file description</li>
</ul>
<p>That&#8217;s it, really.</p>
<p><em>Exercise</em>: Implement this hacky method to &#8220;parse&#8221; a dot file. You don&#8217;t need to remove the unnecessary edges yet. Write the output of your program to a file and diff against the original. They should match except possibly for line ordering and whitespace. You can sort the lines in both files alphabetically using the &#8220;sort&#8221; Unix command for easier comparison. Feel free to reach out to a reference on regular expressions if needed.</p>
</div>
<div class="section" id="removing-unnecessary-edges">
<h2>4.2.1.4. Removing unnecessary edges<a class="headerlink" href="#removing-unnecessary-edges" title="Permalink to this headline">¶</a></h2>
<p>This process, after searching online, reveals to be called <em>transitive reduction</em>.</p>
<p><em>Exercise</em>: look up transitive reduction online.</p>
<p>We already roughly described an algorithm to remove unnecessary edges in pseudocode. Let&#8217;s see what we need to do in order to turn it into real code:</p>
<ul class="simple">
<li>We need to be able to get a list of the direct child nodes of a node. Our dictionary we put together above works well here.</li>
<li>We need to be able to remove the edge between a node and a child node. Again, this is something we should be able to do with our dictionary (with e.g. my_dict[key].remove(node)).</li>
<li>We need to be able to tell if node A is either a direct or an indirect child node of node B, i.e. whether node B depends on node A. We don&#8217;t have this yet.</li>
</ul>
<p>Let&#8217;s implement this algorithm: we need to <em>traverse</em> the graph to be able to tell whether a node depends on another. There are two major kinds of graph traverals, <em>depth first search</em> and <em>breadth first search</em>. In this case it doesn&#8217;t matter which one we pick.</p>
</div>
<div class="section" id="graph-traversal">
<h2>4.2.1.5. Graph traversal<a class="headerlink" href="#graph-traversal" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s take a look at the simpler graph from before again:</p>
<img alt="_images/graph.png" src="_images/graph.png" />
<p>If we were to start our traversal from node A, the depth first traversal, which, as the name says, goes into depth when traversing, would traverse the nodes e.g. in the following order:</p>
<p>A -&gt; B -&gt; D -&gt; E -&gt; C</p>
<p>This is because depth first traversal traverses along the edges of the last visited node first. In other words, depth first traversal maintains a <em>stack</em>, such that any edges from newly visited nodes are added at the top of the stack.</p>
<p>If we were to traverse from node B using breadth first traversal, the order would e.g. be the following:</p>
<p>A -&gt; B -&gt; C -&gt; E -&gt; D</p>
<p>This is because breadth first traversal traverses along the edges of the first visited node first. In other words, breadth first traversal maintains a <em>queue</em>, such that any edges from newly visited nodes are added at the end of the queue.</p>
<p>In Python, a simple list can function either as a stack or a queue, with the pop() member function being able to return (and remove) either the first or the last element of the list, and the insert() and append() functions being able to add elements either the beginning or the end of the list, though Python also has more specific data structures that can be used such as collections.deque.</p>
<p>Finding out whether node B is either directly or indirectly dependent of node A is then a matter of traversing the graph from node A. If node B is encountered, it depends on node A.</p>
<p><em>Exercise</em>: Using your dictionary describing the dependencies in a dot graph, write a traversal function to check if a node is a child node of another. You can use either depth first or breadth first search.</p>
<p>You may recall that function calls are also stored in a stack, such that the computer (or virtual machine) knows where to jump to after a function has finished. This correctly implies that we can implement the depth first search recursively, i.e. instead of having our explicit stack we simply call a recursive function that does the search for us.</p>
<p><em>Exercise</em>: Implement depth first search using recursion.</p>
<p>We should now have all the pieces we need to finish our program.</p>
<p><em>Exercise</em>: Finish the program to remove unnecessary edges. See the pseudocode above for the principle. Use your traversal function to determine whether a node depends on another.</p>
<p>By the way, the Graphviz suite also includes a tool called &#8220;tred&#8221; which performs transitive reduction similarly to our code. You can also use this to validate the output of your program.</p>
<p><em>Exercise</em>: Look up the source code for &#8220;tred&#8221; in the Graphviz source.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="parse.html" title="4.2.2. Parsing"
             >next</a> |</li>
        <li class="right" >
          <a href="py4_index.html" title="4.2. A fistful of Python exercises"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Software Development: A Pragmatic Approach 0.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ch4_index.html" >4. Stage 2</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="py4_index.html" >4.2. A fistful of Python exercises</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Antti Salonen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>